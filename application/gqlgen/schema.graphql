type Query {

    """
    Meetings, aka Events. With no parameters supplied, only future meetings are returned.
    NOT YET IMPLEMENTED: `endAfter`, `endBefore`, `startafter`, `startBefore`
    """
    meetings(
        """
        NOT YET IMPLEMENTED --
        Only include meetings that have an `endDate` after a given day
        """
        endAfter: Date

        """
        NOT YET IMPLEMENTED --
        Only include meetings that have an `endDate` before a given day
        """
        endBefore: Date

        """
        NOT YET IMPLEMENTED --
        Only include meetings that have a `startDate` after a given day
        """
        startAfter: Date

        """
        NOT YET IMPLEMENTED --
        Only include meetings that have a `startDate` before a given day
        """
        startBefore: Date
    ): [Meeting!]!

    "Return a specific meeting (event). If the meeting is not visible to the auth user, an error will be returned."
    meeting(id: ID): Meeting

    "Return a specific message. If the message is not visible to the auth user, an error will be returned."
    message(id: ID): Message!

    "Provides a list of message threads in which the auth user is participating."
    myThreads: [Thread!]!

    "Provides a list of all of the auth user's watches."
    myWatches: [Watch!]!

    "Return a specific organization. Only Super Admins, Sales Admins, and Admins for the requested org are authorized."
    organization(id: ID): Organization!

    "Provides a list of all organizations for which the user is an Admin. Super Admins and Sales Admins see all orgs."
    organizations: [Organization!]!
    post(id: ID): Post

    """
    Posts, aka Requests. With no parameters supplied, all posts visible to the authenticated user are returned. Filter
    parameters only remove from this default list and never include posts that are not visible to the authenticated
    user. For posts associated with a `User` or `Meeting`, use the `posts` field on `User` and `Meeting`.
    """
    posts(
        "Only include posts that have a destination near the given location."
        destination: LocationInput,

        "Only include posts that have an origin near the given location."
        origin: LocationInput

        "Search by text in `title` or `description`"
        searchText: String
    ): [Post!]!

    """
    DEPRECATED: `Query.recentMeetings` will be replaced by the `endAfter` parameter of `Query.meetings`
    """
    recentMeetings: [Meeting!]! @deprecated(reason: "`Query.recentMeetings` will be replaced by `endAfter` parameter of `Query.meetings`")

    "Lists all threads, regardless of visibility. Note that some thread fields may cause authorization errors."
    threads: [Thread!]!

    "List all users in the system. Only Super Admins are authorized for this query."
    user(id: ID): User

    """
    Return a specific user. If the ID is not specified, the authenticated user is returned. Only Super Admins are
    authorized to query a user record other than their own.
    """
    users: [User!]!
}

type Mutation {

    "Create a new meeting (event). At this time, any user may create a meeting."
    createMeeting(input: CreateMeetingInput!): Meeting!

    "Update an existing meeting (event). The meeting creator, Super Admins, Sales Admins, and Admins are authorized."
    updateMeeting(input: UpdateMeetingInput!): Meeting!

    """
    Bulk create `MeetingInvite`s and return the updated list of invites for the specified meeting. Subsequent calls
    can include existing email addresses without error since duplicates are ignored.
    """
    createMeetingInvites(input: CreateMeetingInvitesInput!): [MeetingInvite!]!

    "Remove a `MeetingInvite` and return the remaining invites for the `Meeting`"
    removeMeetingInvite(input: RemoveMeetingInviteInput!): [MeetingInvite!]!

    """
    Create a new `MeetingParticipant` either from a `MeetingInvite`, or by self-joining a meeting. Note that this
    mutation can only be used by a pre-existing user; new users must go through the REST API login process. If the
    `Meeting` is not `INVITE_ONLY`, no `MeetingInvitation` is needed and the `confirmationCode` may be omitted.
    """
    createMeetingParticipant(input: CreateMeetingParticipantInput!): MeetingParticipant!

    "Remove a `MeetingParticipant` and return the remaining participants for the `Meeting`"
    removeMeetingParticipant(input: RemoveMeetingParticipantInput!): [MeetingParticipant!]!

    "Create a new message. Only authorized for posts visible to the auth user."
    createMessage(input: CreateMessageInput!): Message!

    "Create a new organization. Authorized for Super Admins and Sales Admins."
    createOrganization(input: CreateOrganizationInput!): Organization!

    "Update organization properties. Authorized for Super Admins, Sales Admins, and Org Admins on the specified Org."
    updateOrganization(input: UpdateOrganizationInput!): Organization!

    """
    Add a domain to an Organization's domain list. No two organizations may have the same domain. Authorized for Super
    Admins, Sales Admins, and Org Admins on the specified Organization.
    """
    createOrganizationDomain(input: CreateOrganizationDomainInput!): [OrganizationDomain!]!

    """
    Remove a domain from an Organization's domain list. Authorized for Super Admins, Sales Admins, and Org Admins on the
    specified Organization.
    """
    removeOrganizationDomain(input: RemoveOrganizationDomainInput!): [OrganizationDomain!]!

    """
    Update an Organization's domain properties. Cannot be used to change an existing domain name. Authorized for Super
    Admins, Sales Admins, and Org Admins on the specified Organization.
    """
    updateOrganizationDomain(input: CreateOrganizationDomainInput!): [OrganizationDomain!]!

    """
    Create a trust relationship (affilition) between two Organizations. At the present time, this creates a mutual
    trust between the two specified Organizations. A trust allows posts (requests) and meetings (events) to be visible
    to users of a different Organization than their own.  Authorized for Super Admins and Sales Admins.
    """
    createOrganizationTrust(input: CreateOrganizationTrustInput!): Organization!

    """
    Remove a trust relationship (affiliation) between two Organizations.  At the present time, this removes both sides
    of a mutual trust between the two specified Organizations. Authorized for Super Admins, Sales Admins, and Org Admins
    on the primary Organization.
    """
    removeOrganizationTrust(input: RemoveOrganizationTrustInput!): Organization!

    """
    Create a new Post (Request). Any user may create a standard Post. For meeting-related posts, the meeting must be
    visible to the auth user.
    """
    createPost(input: CreatePostInput!): Post!

    """
    Update Post (Request) properties. The auth user must be the post creator or a Super Admin, and the post must be in
    an editable state (e.g. not COMPLETED) as identified by the `isEditable` field.
    """
    updatePost(input: UpdatePostInput!): Post!

    """
    Update the Status field on a Post (Request). The post creator and Super Admins can make most status changes. The
    provider can make limited changes (e.g. to DELIVERED).
    """
    updatePostStatus(input: UpdatePostStatusInput!): Post!

    "Make an offer to carry a request. Only allowed if the status is OPEN and the post is visible to the auth user."
    addMeAsPotentialProvider(postID: String!): Post!

    "Cancel a carry offer by auth user. Authorized for the post creator, the potential provider, and Super Admins."
    removeMeAsPotentialProvider(postID: String!): Post!

    "Cancel a carry offer for any user. Authorized for the post creator, the potential provider, and Super Admins."
    removePotentialProvider(postID: String!, userID: String!): Post!

    """
    Set the LastViewedAt time for a message thread. Effectively clears the unread status of messages updated before the
    given time. The auth user must be a participant (i.e. sent or received a message) in the specified thread.
    """
    setThreadLastViewedAt(input: SetThreadLastViewedAtInput!): Thread!

    "Update User profile information. If ID is not specified, the authenticated user is assumed."
    updateUser(input: UpdateUserInput!): User!

    """
    Create a Watch for a given location. Posts (requests) with a destination near the watch location will trigger a
    notification to the watch creator. Other types of Watches (e.g. keyword search) may be created in future versions of
    WeCarry. Any user may create a Watch.
    """
    createWatch(input: CreateWatchInput!): Watch!

    "Remove a Watch. Only the Watch creator is authorized."
    removeWatch(input: RemoveWatchInput!): [Watch!]!

    "Update Watch properties. Only the Watch creator is authorized."
    updateWatch(input: UpdateWatchInput!): Watch!
}

"Date in ISO-8601 format (e.g. 2020-02-11)"
scalar Date

"Date and Time in ISO-8601 format (e.g. 2020-02-11T18:08:56Z)"
scalar Time

"Visibility for Meetings (Events), determines who can see a `Meeting`."
enum MeetingVisibility {
    "Visible to invitees and all app users"
    ALL
    "Visible to invitees and members of the `Meeting` organization and affiliated organizations"
    TRUSTED
    "Visible to invitees and members of the `Meeting` organization"
    ORGANIZATION
    "Visible only to invitees"
    INVITE_ONLY
}

enum PostRole {
    CREATEDBY
    RECEIVING
    PROVIDING
}

enum PostSize {
    TINY
    SMALL
    MEDIUM
    LARGE
    XLARGE
}

enum PostStatus {
    OPEN
    ACCEPTED
    DELIVERED
    RECEIVED
    COMPLETED
    REMOVED
}

enum PostType {
    REQUEST
    OFFER
}

"Visibility for Posts, ALL organizations, TRUSTED organizations, or SAME organization only"
enum PostVisibility {
    "Visible to all users from all organizations in the system"
    ALL
    "Visible to users from all organizations trusted by the Post creator's organization"
    TRUSTED
    "Visible only to users from the same organization as the Post creator"
    SAME
}

enum PreferredLanguage {
    EN
    FR
    SP
    KO
    PT
}

enum PreferredWeightUnit {
    POUNDS
    KILOGRAMS
}

enum UserAdminRole {
    SUPERADMIN
    SALESADMIN
    ADMIN
    USER
}

type File {
    id: ID!
    url: String!
    urlExpiration: Time!
    name: String!
    size: Int!
    contentType: String!
}

"Describes a Geographic location"
type Location {
    description: String!
    # Country, ISO 3166-1 Alpha-2 code
    country: String!
    latitude: Float
    longitude: Float
}

"Specify a Geographic location"
input LocationInput {
    description: String!
    # Country, ISO 3166-1 Alpha-2 code
    country: String!
    latitude: Float
    longitude: Float
}

type Meeting {
    id: ID!
    name: String!
    description: String
    moreInfoURL: String
    startDate: Date!
    endDate: Date!
    createdAt: Time!
    updatedAt: Time!
    createdBy: PublicProfile!
    imageFile: File
    location: Location!

    "Posts (Requests) associated with the meeting"
    posts: [Post!]!

    "NOT YET IMPLEMENTED -- Who can see this meeting"
    visibility: MeetingVisibility!

    "Invites to the `Meeting` that have been sent to the invitees for their confirmation to join the `Meeting`"
    invites: [MeetingInvite!]!

    "Participants of a `Meeting` are able to see all posts associated with the `Meeting`"
    participants: [MeetingParticipant!]!

    "Organizers of a `Meeting` are able to make changes and invite people"
    organizers: [PublicProfile!]!
}

input CreateMeetingInput {
    name: String!
    description: String
    startDate: Date!
    endDate: Date!
    moreInfoURL: String
    imageFileID: ID
    location: LocationInput!

    "NOT YET IMPLEMENTED -- Who can see this meeting"
    visibility: MeetingVisibility!
}

input UpdateMeetingInput {
    id: ID!
    name: String!
    description: String
    startDate: Date!
    endDate: Date!
    moreInfoURL: String
    imageFileID: ID
    location: LocationInput!

    "NOT YET IMPLEMENTED -- Who can see this meeting"
    visibility: MeetingVisibility!
}

"""
Invite to a `Meeting`. An invite must be confirmed by the invitee before they may be added to a `Meeting`.
"""
type MeetingInvite {
    meeting: Meeting!
    "`User` making the invite"
    inviter: PublicProfile!
    "Email address of the invitee"
    email: String!
    "Gravatar image URL. Always a valid URL, but depending on the email address, it may reference a generic avatar."
    avatarURL: String!
}

"Input object for `createMeetingInvites`"
input CreateMeetingInvitesInput {
    "ID of the `Meeting`"
    meetingID: ID!

    "Email addresses of the invitees. Duplicate values are ignored."
    emails: [String!]!

    "NOT YET IMPLEMENTED -- Send email invites. Default is 'false', do not send any emails."
    sendEmail: Boolean
}

"Input object for `removeMeetingInvite`"
input RemoveMeetingInviteInput {
    "ID of the `Meeting`"
    meetingID: ID!
    "Email addresse of the invitee to remove"
    email: String!
}

"""
Confirmed participant of a `Meeting`. An invited person will not appear as a `MeetingParticipant` until they have
confirmed a `MeetingInvite`.
"""
type MeetingParticipant {
    meeting: Meeting!
    "`User` information for the `Meeting` participant"
    user: User!
    "true if `User` is a meeting Organizer"
    isOrganizer: Boolean
    "The `MeetingInvite`, valid if the participant was invited. `null` indicates the `User` self-joined"
    invite: MeetingInvite
}

"Input object for `createMeetingParticipant`"
input CreateMeetingParticipantInput {
    "ID of the `Meeting`"
    meetingID: ID!
    """
    Secret code from the `MeetingInvite` or invite code from the `Meeting`. If the `Meeting` is not `INVITE_ONLY`,
    the code may be omitted.
    """
    code: String
    "NOT YET IMPLEMENTED -- Add as a `Meeting` Organizer. Authenticated `User` must be authorized [definition TBD] to do this. "
    isOrganizer: Boolean
}

"Input object for `removeMeetingParticipant`"
input RemoveMeetingParticipantInput {
    "ID of the `Meeting`"
    meetingID: ID!
    "`User` ID of the `Meeting` participant to remove"
    userID: ID!
}

type Message {
    id: ID!
    sender: PublicProfile!
    content: String!
    thread: Thread!
    createdAt: Time!
    updatedAt: Time!
}

input CreateMessageInput {
    content: String!
    postID: String!
    threadID: String
}

type Organization {
    id: ID!
    name: String!
    url: String
    createdAt: Time!
    updatedAt: Time!
    domains: [OrganizationDomain!]!
    logoURL: String
    trustedOrganizations: [Organization!]!
}

input CreateOrganizationInput {
    name: String!
    url: String
    authType: String!
    authConfig: String!
    logoFileID: ID
}

input UpdateOrganizationInput {
    id: ID!
    name: String!
    url: String
    authType: String!
    authConfig: String!
    logoFileID: ID
}

type OrganizationDomain {
    domain: String!
    organizationID: ID!
    authType: String!
    authConfig: String!
}

input CreateOrganizationDomainInput {
    domain: String!
    organizationID: ID!
    authType: String
    authConfig: String
}

input RemoveOrganizationDomainInput {
    domain: String!
    organizationID: ID!
}

input CreateOrganizationTrustInput {
    primaryID: ID!
    secondaryID: ID!
}

input RemoveOrganizationTrustInput {
    primaryID: ID!
    secondaryID: ID!
}

type Post {
    id: ID!
    type: PostType!
    "Profile of the user that created this post."
    createdBy: PublicProfile!
    "Profile of the user that is receiver of this post. For requests, this is the same as `createdBy`."
    receiver: PublicProfile
    "Profile of the user that is the provider for this post. For offers, this is the same as `createdBy`."
    provider: PublicProfile
    potentialProviders: [PublicProfile!]
    "Organization associated with this post."
    organization: Organization
    "Short description of item"
    title: String!
    "Optional, longer description of the item."
    description: String
    "Geographic location where item is needed"
    destination: Location!
    "Date (yyyy-mm-dd) before which the item will be needed. The record may be hidden or removed after this date."
    neededBefore: Date
    "Date (yyyy-mm-dd) on which the request moved into the COMPLETED status"
    completedOn: Date
    "Optional geographic location where the item can be picked up, purchased, or otherwise obtained"
    origin: Location
    "Broad category of the size of item"
    size: PostSize!
    "Status of the post. Use mutation `updatePostStatus` to change the status."
    status: PostStatus!
    "List of message threads associated with this post"
    threads: [Thread!]!
    "Date and time this post was created"
    createdAt: Time!
    "Date and time this post was last updated"
    updatedAt: Time!
    "Optional URL to further describe or point to detail about the item"
    url: String
    "Optional weight of the item, measured in kilograms"
    kilograms: Float
    "Photo of the item"
    photo: File
    "UUID of the photo of the item"
    photoID: ID
    "List of attached files. Does not include the post photo."
    files: [File!]!
    "Meeting associated with this post. Affects visibility of the post."
    meeting: Meeting
    "Dynamically set to indicate if the current user is allowed to edit this post using the `updatePost` mutation"
    isEditable: Boolean!
    "Visibility restrictions for this post"
    visibility: PostVisibility!
}

input CreatePostInput {
    "ID of associated Organization. Affects visibility of the post, see also the `visibility` field."
    orgID: String!
    type: PostType!
    "Short description, limited to 255 characters"
    title: String!
    "Optional, longer description, limited to 4096 characters"
    description: String
    "Geographic location where item is needed"
    destination: LocationInput!
    "Date (yyyy-mm-dd) before which the item will be needed. The record may be hidden or removed after this date."
    neededBefore: Date
    "Optional geographic location where the item can be picked up, purchased, or otherwise obtained"
    origin: LocationInput
    "Broad category of the size of item"
    size: PostSize!
    "Optional URL to further describe or point to detail about the item"
    url: String
    "Optional weight of the item, measured in kilograms"
    kilograms: Float
    "Optional photo `file` ID. First upload a file using the `/upload` REST API and then submit its ID here."
    photoID: ID
    "Optional meeting ID. Affects visibility of the post."
    meetingID: ID
    "Visibility restrictions for this post"
    visibility: PostVisibility
}

input UpdatePostInput {
    "ID of the post to update"
    id: ID!
    "Short description, limited to 255 characters. If omitted or `null`, no change is made."
    title: String
    "Longer description, limited to 4096 characters. If omitted or `null`, the description is removed"
    description: String
    "Geographic location where item is needed. If omitted or `null`, no change is made."
    destination: LocationInput
    """
    Date (yyyy-mm-dd) before which the item will be needed. The record may be hidden or removed after this date. If
    omitted or `null`, the date is removed.
    """
    neededBefore: Date
    """
    Optional geographic location where the item can be picked up, purchased, or otherwise obtained. If omitted or
    `null`, the origin location is removed.
    """
    origin: LocationInput
    "Broad category of the size of item. If omitted or `null`, no change is made."
    size: PostSize
    "Optional URL to further describe or point to detail about the item. If omitted or `null`, the URL is removed."
    url: String
    "Optional weight of the item, measured in kilograms. If omitted or `null`, the value is removed."
    kilograms: Float
    """
    Optional photo `file` ID. First upload a file using the `/upload` REST API and then submit its ID here. Any
    previously attached photo will be deleted. If omitted or `null`, no photo will be attached to this post.
    """
    photoID: ID
    "Visibility restrictions for this post. If omitted or `null`, the visibility is set to `ALL`."
    visibility: PostVisibility
}

input UpdatePostStatusInput {
    id: ID!
    status: PostStatus!
    providerUserID: ID
}

type Thread {
    id: ID!
    participants: [PublicProfile!]!
    messages: [Message!]!
    postID: String!
    post: Post!
    lastViewedAt: Time!
    createdAt: Time!
    updatedAt: Time!
    unreadMessageCount: Int!
}

input SetThreadLastViewedAtInput {
    threadID: ID!
    time: Time!
}

type User {
    id: ID!
    email: String!
    nickname: String!
    createdAt: Time!
    updatedAt: Time!
    adminRole: UserAdminRole
    "avatarURL is generated from an attached photo if present, an external URL if present, or a Gravatar URL"
    avatarURL: String
    "`File` ID of the user's photo, if present"
    photoID: String
    preferences: UserPreferences
    "user's home location"
    location: Location
    unreadMessageCount: Int!
    organizations: [Organization!]!
    posts(role: PostRole!): [Post!]!
    "meetings in which the user is a participant"
    meetingsAsParticipant: [Meeting!]!
}

"User fields that can safely be visible to any user in the system"
type PublicProfile {
    id: ID!
    nickname: String!
    avatarURL: String
}

"Input object for `updateUser`"
input UpdateUserInput {
    id: ID
    nickname: String
    "File ID of avatar photo. If omitted or `null`, the photo is removed from the profile."
    photoID: String
    """
    Specify the user's "home" location. If omitted or `null`, the location is removed from the profile.
    """
    location: LocationInput
    preferences: UpdateUserPreferencesInput
}

type UserPreferences {
    language: String
    timeZone: String
    weightUnit: String
}

input UpdateUserPreferencesInput {
    language: PreferredLanguage
    timeZone: String
    weightUnit: PreferredWeightUnit
}

type Watch {
    id: ID!
    owner: PublicProfile!
    location: Location
}

input CreateWatchInput {
    location: LocationInput
}

input RemoveWatchInput {
    id: ID!
}

input UpdateWatchInput {
    id: ID!
    location: LocationInput
}
